import pandas as pd
from sklearn.linear_model import LinearRegression

# You can also use this section to suppress warnings generated by your code:
def warn(*args, **kwargs):
    pass
import warnings
warnings.warn = warn
warnings.filterwarnings('ignore')

"""
Task 1 - Load the data in a csv file into a dataframe
"""

# the data set is available at the url below.
URL = "https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-BD0231EN-SkillsNetwork/datasets/mpg.csv"

# using the read_csv function in the pandas library, we load the data into a dataframe.
df = pd.read_csv(URL)

# show 5 random rows from the dataset
df.sample(5)

# show the shape of the dataframe
df.shape

# create a scatter plot of Horsepower vs MPG(Miles Per Gallon)
df.plot.scatter(x = "Horsepower", y = "MPG")

"""
Task 2 - Identify the target column and the data columns
"""

# Target is the value that our machine learning model needs to predict
target = df["MPG"]

# Features are the values that our machine learning model uses to make predictions
features = df[["Horsepower", "Weight"]]

"""
Task 3 - Build and Train a Linear Regression Model
"""

# Create a Linear Regression model
lr = LinearRegression()

# Train the model using the features and target
lr.fit(features, target)

"""
Task 4 - Evaluate the model and make predictions
"""

#Higher the score, better the model.
lr.score(features,target)
# Show the score of the model
print("Model Score:", lr.score(features, target))

# Make predictions using the trained model
predictions = lr.predict([[100, 2000], [150, 2500], [200, 3000]])
# Show the predictions 
print("Predicted MPG for a car with Horsepower and Weight:", predictions)
